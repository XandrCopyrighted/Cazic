steps:
  rust:
    image: rust
    commands:
      - rustup toolchain install --profile=minimal stable
    when:
      event: [push, pull_request]
      branch: main

  tauri-cargo-build:
    image: rust
    commands:
      - cargo install tauri-cli
      - apt-get update
      - apt-get install -y libgtk-3-dev libwebkit2gtk-4.0-dev libappindicator3-dev librsvg2-dev libxcb-shape0-dev libxcb-xfixes0-dev libxdo-dev
      - cargo tauri build
    when:
      event: [push, pull_request]
      branch: main

  zip-artifact:
    image: ubuntu
    commands:
      - zip -r cazic_linux.zip target/release/bundle/*deb target/release/bundle/appimage/*